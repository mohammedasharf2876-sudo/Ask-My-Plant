<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุดุชู ูุญูุฏ ุงูุฐูู</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            background-color: #efe7dd; /* ููู ุฎูููุฉ ูุงุชุณุงุจ */
            margin: 0; 
            display: flex; 
            flex-direction: column; 
            height: 100vh; 
        }

        .header { 
            background-color: #008069; 
            color: white; 
            padding: 10px 15px; 
            display: flex; 
            align-items: center; 
            gap: 10px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
            z-index: 100;
        }
        
        .avatar {
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .chat-area { 
            flex: 1; 
            padding: 20px; 
            overflow-y: auto; 
            display: flex; 
            flex-direction: column; 
            gap: 10px; 
            background-image: url("https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png");
            background-repeat: repeat;
        }

        .message { 
            padding: 8px 12px; 
            border-radius: 8px; 
            max-width: 80%; 
            font-size: 14.2px; 
            line-height: 19px; 
            position: relative; 
            box-shadow: 0 1px 0.5px rgba(0,0,0,0.13);
            word-wrap: break-word;
        }

        .bot { 
            background: white; 
            align-self: flex-start; 
            border-top-left-radius: 0; 
        }

        .user { 
            background: #d9fdd3; 
            align-self: flex-end; 
            border-top-right-radius: 0; 
        }

        .time {
            font-size: 11px;
            color: #999;
            float: left;
            margin-top: 4px;
            margin-right: -5px;
        }

        .input-box { 
            background: #f0f2f5; 
            padding: 10px; 
            display: flex; 
            align-items: center; 
            gap: 8px; 
        }

        input { 
            flex: 1; 
            padding: 12px; 
            border-radius: 8px; 
            border: none; 
            outline: none; 
            font-size: 16px; 
            background: white;
        }

        button { 
            background: #008069; 
            color: white; 
            border: none; 
            padding: 10px; 
            border-radius: 50%; 
            cursor: pointer; 
            width: 40px; 
            height: 40px; 
            display: flex; 
            align-items: center; 
            justify-content: center;
        }
    </style>
</head>
<body>

    <div class="header">
        <div class="avatar">๐ฑ</div>
        <div style="flex: 1;">
            <div style="font-weight: bold; font-size: 16px;" id="headerName">ูุดุชู ูุญูุฏ</div>
            <div style="font-size: 12px; opacity: 0.8;">ูุชุตู ุงูุขู</div>
        </div>
    </div>

    <div class="chat-area" id="chatBox"></div>

    <div class="input-box">
        <input type="text" id="userInput" placeholder="ุงูุชุจ ุฑุณุงูุฉ..." onkeypress="handleEnter(event)">
        <button onclick="sendMessage()">โค</button>
    </div>

<script>
    // --- ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุงููุฉ ---
    const plantDB = {
        "ุนุงูุฉ": { w: "ูุนุธู ุงููุจุงุชุงุช ุจุชุญุจ ุงูุชุฑุจุฉ ุชุฌู ุดููุฉ ูุจู ุงูุฑู.", s: "ุฃุบูุจ ุงููุจุงุชุงุช ุจุชุญุชุงุฌ ุถูุก ููู ุบูุฑ ูุจุงุดุฑ.", f: "ุณูุงุฏ NPK ูุชูุงุฒู ูุฑุฉ ูู ุดูุฑ ููุชุงุฒ.", n: "ุฃูุง ูููุฏุณ ุฒุฑุงุนู ุขููุ ุงุณุฃููู ูู ุงูุนููู!" },
        "ุฑูุญุงู": { w: "ููู ูููู (ุจูุญุจ ุงูููุฉ)", s: "ุดูุณ ูุจุงุดุฑุฉ ูููุงู ูุชููู", f: "ุนุถูู ูู ุดูุฑ", n: "ุงูุทู ุงูููู ุงููุงููุฉ ุนุดุงู ููุฑุน." },
        "ูุนูุงุน": { w: "ูู ููู ูู ุงูุตูู", s: "ุดูุณ ุฎูููุฉ ุฃู ูุตู ุธู", f: "NPK ูุชูุงุฒู", n: "ุฌุฐูุฑู ูููุฉุ ุงุฒุฑุนู ููุญุฏู." },
        "ุฑูุฒูุงุฑู": { w: "ููุง ุงูุชุฑุจุฉ ุชูุดู ุชูุงูุงู", s: "ุดูุณ ุญุงุฑูุฉ", f: "ูููู ุฌุฏุงู", n: "ููุชุงุฒ ูู ุงูุทุจุฎ." },
        "ุฒุนุชุฑ": { w: "ูููู ุฌุฏุงู", s: "ุดูุณ ูุงููุฉ", f: "ูุฑุฉ ูู ููุณู", n: "ุจูุชุญูู ุงูุนุทุด." },
        "ูุฑุฏ ุจูุฏู": { w: "ููู ูููู ุจุงูุชุธุงู", s: "ุดูุณ 6 ุณุงุนุงุช ุนุงูุฃูู", f: "ุนุงูู ุงูุจูุชุงุณููู", n: "ูุต ุงููุฑุฏ ุงูุฏุจูุงู." },
        "ูู": { w: "ูู ููููู", s: "ุดูุณ ูุบุฑุจูุฉ", f: "ุญุฏูุฏ ูู ุดูุฑ", n: "ุฑูุญุชู ุจุชุทูุน ุจููู." },
        "ูุงุณููู": { w: "ูุนุชุฏู", s: "ุดูุณ ูุงููุฉ", f: "ูุชูุงุฒู", n: "ูุจุงุช ูุชุณูู." },
        "ุฌุงุฑุฏูููุง": { w: "ููุฉ ููุชุฑ (ุจุฏูู ูููุฑ)", s: "ุถูุก ููู ุฌุฏุงู ุจุฏูู ุดูุณ", f: "ุญุฏูุฏ ูุณูุงุฏ ุญุงูุถู", n: "ุญุณุงุณุฉ ูุชุบููุฑ ุงูููุงู." },
        "ูุณู ุงูููู": { w: "ููู ูููู", s: "ุดูุณ ูุจุงุดุฑุฉ", f: "ุจูุฏู", n: "ุฑูุญุชู ููุงุญุฉ ุฌุฏุงู." },
        "ุฌููููุฉ": { w: "ุชุนุทูุด ุนุดุงู ุชุฒูุฑ", s: "ุดูุณ ุญุงุฑูุฉ", f: "ูุด ูุญุชุงุฌุฉ", n: "ูููุฉ ุงูุดูุณ." },
        "ุจูุชุณ": { w: "ูู 5 ุฃูุงู (ููุง ุชูุดู)", s: "ุถู (ุถูุก ุดุจุงู)", f: "ูุฑูู", n: "ูููู ููููุงุก." },
        "ุฌูุฏ ุงูููุฑ": { w: "ูู ุฃุณุจูุนูู ูุฑุฉ", s: "ุฃู ุฅุถุงุกุฉ", f: "ูุด ูุญุชุงุฌ", n: "ุจูุณุชุญูู ุงูุฅููุงู." },
        "ุฒุงููุง": { w: "ูุฑุฉ ูู 20 ููู", s: "ุถู ูุงูู", f: "NPK ูู ุดูุฑูู", n: "ุดูู ุฌุฏุงู ูุจุทูุฆุฉ ุงูููู." },
        "ูููุณุชููุฑุง": { w: "ููุง ูุต ุงูุชุฑุจุฉ ููุดู", s: "ุถูุก ุณุงุทุน", f: "NPK", n: "ุงูุณุญ ูุฑููุง ุจููุงุดุฉ ูุจูููุฉ." },
        "ุตุจุงุฑ": { w: "ููุทุฉ ูู ุดูุฑ", s: "ุดูุณ ุฃู ุถูุก ููู", f: "ูุง ููุฌุฏ", n: "ูุจูููุชุด ุบูุฑ ูู ูุชุฑ ุงูููุฉ." },
        "ุงููููุฑุง": { w: "ูู 3 ุฃุณุงุจูุน", s: "ุดูุณ ุฎูููุฉ", f: "ุณููู", n: "ูููุฏ ููุจุดุฑุฉ." },
        "ูููุณ ูุชุฏุง": { w: "ููู ูููู", s: "ุดูุณ", f: "ููุชุฑูุฌูู", n: "ุจูุชุนูู ุณูุฑ." },
        "ููููู": { w: "ููุชุธู", s: "ุดูุณ ูุงููุฉ", f: "ุญุฏูุฏ", n: "ูุญุชุงุฌ ุดูุณ ูุชุณููุฏ ุนุดุงู ูุทุฑุญ." }
    };

    // ุชุญุฏูุฏ ููุน ุงูุฒุฑุนุฉ ูู ุงูุฑุงุจุท
    const params = new URLSearchParams(window.location.search);
    let pType = params.get('type');
    
    // ุชุตุญูุญ ุงูุฎุทุฃ ุงูุบุจู: ูู ูููุด ููุนุ ุงุนุชุจุฑู "ุนุงูุฉ"
    if (!pType) {
        pType = "ุนุงูุฉ";
    } else {
        pType = pType.replace(/_/g, ' ');
    }

    document.getElementById('headerName').innerText = pType === "ุนุงูุฉ" ? "ูุดุชู ูุญูุฏ ุงูุฐูู" : "ูุจุชุฉ: " + pType;

    // ุฏุงูุฉ ุฅุถุงูุฉ ุงูุฑุณุงูุฉ
    function addMsg(text, side) {
        const box = document.getElementById('chatBox');
        const div = document.createElement('div');
        div.className = `message ${side}`;
        const t = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        div.innerHTML = `${text} <span class="time">${t}</span>`;
        box.appendChild(div);
        box.scrollTop = box.scrollHeight;
    }

    // ุฑุณุงูุฉ ุงูุชุฑุญูุจ
    setTimeout(() => {
        let welcome = "";
        if (pType === "ุนุงูุฉ") {
            welcome = "ุฃููุงู ูุง ููุงู! ๐<br>ุฃูุง ุงููุณุงุนุฏ ุงูุฐูู ููุดุชู ูุญูุฏ. ุงุณุฃููู ุฃู ุณุคุงู ุนู ุงูุฒุฑุน ููุฌุงูุจู.";
        } else {
            welcome = `ุฃููุงู! ุฃูุง ูุจุชุฉ <b>${pType}</b>. ๐<br>ุงุณุฃููู ุนู ุงูุฑู ุฃู ุงูููุงู ุงูููุงุณุจ!`;
        }
        addMsg(welcome, 'bot');
    }, 500);

    function handleEnter(e) { if (e.key === 'Enter') sendMessage(); }

    function sendMessage() {
        const input = document.getElementById('userInput');
        const text = input.value.trim().toLowerCase();
        if (!text) return;

        addMsg(text, 'user');
        input.value = "";

        setTimeout(() => {
            const info = plantDB[pType] || plantDB["ุนุงูุฉ"]; // ูู ุงูุฒุฑุนุฉ ูุด ููุฌูุฏุฉุ ุงุณุชุฎุฏู ุงูุนุงูุฉ
            let reply = "";

            // ุงูุฑุฏูุฏ ุงูุนุงูุฉ (ุชุนูู ูุน ูู ุงูุฃููุงุน)
            if (text.includes("ุณุนุฑ") || text.includes("ูุงู") || text.includes("ุจูุงุจ")) {
                reply = "ุงูุฃุณุนุงุฑ ูููุฒุฉ ุฌุฏุงู ุนูุฏูุง.. ุดุฑููุง ูู ุงููุดุชู ููุงุจุชู ูุญูุฏ ููุนูู ูุนุงู ุงููุงุฌุจ! ๐";
            }
            else if (text.includes("ุงุฒูู") || text.includes("ุงุฎุจุงุฑู") || text.includes("ุนุงูู")) {
                reply = "ุฃูุง ุฒู ุงููู ุทูู ูุง ุฅูุช ููุชู ุจุงูุฒุฑุน! ๐ฟ";
            }
            else if (text.includes("ุดูุฑุง") || text.includes("ุญุจูุจู")) {
                reply = "ุงูุนูู ูุง ุบุงูู! ๐";
            }
            // ุงูุฑุฏูุฏ ุงูุฎุงุตุฉ ุจุงูุฒุฑุงุนุฉ
            else if (text.includes("ููุฉ") || text.includes("ุฑู") || text.includes("ุงุณูู") || text.includes("ุดุฑุจ")) {
                reply = `๐ง <b>ุงูุฑู:</b> ${info.w}`;
            }
            else if (text.includes("ุดูุณ") || text.includes("ููุฑ") || text.includes("ููุงู") || text.includes("ุถูุก")) {
                reply = `โ๏ธ <b>ุงูููุงู:</b> ${info.s}`;
            }
            else if (text.includes("ุณูุงุฏ") || text.includes("ุงูู") || text.includes("ุบุฐุง")) {
                reply = `๐ <b>ุงูุชุณููุฏ:</b> ${info.f}`;
            }
            else if (text.includes("ูุตูุญุฉ") || text.includes("ูุนูููุฉ")) {
                reply = `๐ก <b>ุฎุฏ ุฏู:</b> ${info.n}`;
            }
            else {
                // ุงูุฑุฏ ุงูุงูุชุฑุงุถู ูู ููููุด ุงูุณุคุงู (ุจุฏู ุฑุณุงูุฉ ุงูุฎุทุฃ)
                if (pType === "ุนุงูุฉ") {
                    reply = "ุณุคุงู ุฌููู! ุจุณ ุฃูุง ุชุฎุตุตู ูู ุงูุฑู ูุงูุดูุณ ูุงูุชุณููุฏ. ุงุณุฃููู ูู ุฏูู.";
                } else {
                    reply = `ูููู ุชูุถุญ ุฃูุชุฑุ ุงุณุฃููู ูุซูุงู: "ุงุณูููู ุฅุฒุงูุ" ุฃู "ุจุชุญุจู ุงูุดูุณุ"`;
                }
            }

            addMsg(reply, 'bot');
        }, 500);
    }
</script>
</body>
</html>
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุดุชู ูุญูุฏ ุงูุฐูู</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            background-color: #efe7dd; 
            margin: 0; 
            display: flex; 
            flex-direction: column; 
            height: 100vh; 
        }
        .header { 
            background-color: #008069; 
            color: white; 
            padding: 10px 15px; 
            display: flex; 
            align-items: center; 
            gap: 10px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
            z-index: 100;
        }
        .avatar {
            width: 40px; height: 40px; background: white; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; font-size: 20px;
        }
        .chat-area { 
            flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; 
            background-image: url("https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png");
        }
        .message { 
            padding: 8px 12px; border-radius: 8px; max-width: 80%; font-size: 14.2px; line-height: 19px; 
            position: relative; box-shadow: 0 1px 0.5px rgba(0,0,0,0.13); word-wrap: break-word;
        }
        .bot { background: white; align-self: flex-start; border-top-left-radius: 0; }
        .user { background: #d9fdd3; align-self: flex-end; border-top-right-radius: 0; }
        .time { font-size: 11px; color: #999; float: left; margin-top: 4px; margin-right: -5px; }
        .input-box { background: #f0f2f5; padding: 10px; display: flex; align-items: center; gap: 8px; }
        input { flex: 1; padding: 12px; border-radius: 20px; border: none; outline: none; font-size: 16px; background: white; }
        button { background: #008069; color: white; border: none; padding: 10px; border-radius: 50%; cursor: pointer; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>

    <div class="header">
        <div class="avatar">๐ฑ</div>
        <div style="flex: 1;">
            <div style="font-weight: bold; font-size: 16px;" id="headerName">ูุดุชู ูุญูุฏ</div>
            <div style="font-size: 12px; opacity: 0.8;">ูุชุตู ุงูุขู</div>
        </div>
    </div>

    <div class="chat-area" id="chatBox"></div>

    <div class="input-box">
        <input type="text" id="userInput" placeholder="ุงูุชุจ ุฑุณุงูุฉ..." onkeypress="handleEnter(event)">
        <button onclick="sendMessage()">โค</button>
    </div>

<script>
    // --- ูุงุนุฏุฉ ุจูุงูุงุช ุงูู 50 ุฒุฑุนุฉ ูุงููุฉ ---
    const plantDB = {
        // --- 1. ุนุทุฑูุงุช ูุฃุนุดุงุจ ---
        "ุฑูุญุงู": { w: "ููู ูููู (ุงูุชุฑุจุฉ ุฑุทุจุฉ ุฏุงุฆูุงู)", s: "ุดูุณ ูุจุงุดุฑุฉ ูููุงู ูุชููู", f: "ุณูุงุฏ ุนุถูู ูู ุดูุฑ", n: "ุงูุทู ุงูููู ุงููุงููุฉ ุนุดุงู ููุจุฑ ูููุฑุน." },
        "ูุนูุงุน": { w: "ูู ููู ูู ุงูุตูู (ุจูุญุจ ุงูููุฉ)", s: "ุดูุณ ุฎูููุฉ ุฃู ูุตู ุธู", f: "ุณูุงุฏ ูุชูุงุฒู NPK", n: "ุงูุฌุฐูุฑ ุจุชูุชุฏ ุจุณุฑุนุฉุ ููุถู ูู ุฃุตูุต ููุญุฏู." },
        "ุฑูุฒูุงุฑู": { w: "ููุง ุงูุชุฑุจุฉ ุชูุดู ุชูุงูุงู", s: "ุดูุณ ุญุงุฑูุฉ (ุจูุชุญูู)", f: "ูุด ูุญุชุงุฌ ุชุณููุฏ ูุชูุฑ", n: "ููุชุงุฒ ูู ุงูุทุจุฎ ูุฑูุญุชู ุจุชุทุฑุฏ ุงูุญุดุฑุงุช." },
        "ุฒุนุชุฑ": { w: "ูููู ุฌุฏุงู (ุจููุฑู ุงูููุฉ ุงููุชูุฑ)", s: "ุดูุณ ูุงููุฉ", f: "ูุฑุฉ ูู ููุณู", n: "ุนุดุจุฉ ูููุฉ ูุจุชุชุญูู ุงูุฌูุงู." },
        "ูุงููุฏุฑ": { w: "ููุง ุงูุชุฑุจุฉ ุชุฌู (ุจููุฑู ุงูุฑุทูุจุฉ)", s: "ุดูุณ ูููุฉ ุฌุฏุงู", f: "ูููู ุฌุฏุงู", n: "ุฑูุญุชู ููุฏุฆุฉ ูุจูุญุจ ุงูุฌู ุงูุฌุงู." },
        "ูุนูุงุน ุณุนูุฏู": { w: "ููุฉ ูุชูุฑ (ุฒู ุงูุจูุฏู)", s: "ูุตู ุธู", f: "ุนุถูู", n: "ูุฑูุชู ุตุบูุฑุฉ ูุฑูุญุชู ุฃููู." },
        "ุจุฑุฏููุด": { w: "ูุนุชุฏู", s: "ุดูุณ", f: "ูุชูุงุฒู", n: "ูููุฏ ุฌุฏุงู ูููุนุฏุฉ." },
        "ุนุทุฑ ุดุงู": { w: "ููู ูููู", s: "ุดูุณ ุฎูููุฉ", f: "ุนุถูู", n: "ูุฑูู ุจูุชุญุท ูู ุงูุดุงู ุจูุฏู ุฑูุญุฉ ุชุญูุฉ." },

        // --- 2. ุฒููุฑ ููุฒูุฑุงุช ---
        "ูุฑุฏ ุจูุฏู": { w: "ููู ูููู ุจุงูุชุธุงู", s: "ุดูุณ ูุจุงุดุฑุฉ 6 ุณุงุนุงุช ุนุงูุฃูู", f: "NPK ุนุงูู ุงูุจูุชุงุณููู ุนุดุงู ูุฒูุฑ", n: "ูุต ุงููุฑุฏ ุงูุฏุจูุงู ุฃูู ุจุฃูู ุนุดุงู ูุทูุน ุฌุฏูุฏ." },
        "ูู": { w: "ูู ููููู (ุชุฑุจุฉ ุฑุทุจุฉ)", s: "ุดูุณ ูุบุฑุจูุฉ (ูุด ุญุงุฑูุฉ)", f: "ุญุฏูุฏ ูู ุดูุฑ ุนุดุงู ุงููุฑู ููุตูุฑุด", n: "ุฑูุญุชู ููุงุญุฉ ุฌุฏุงู ููุช ุงูุบุฑูุจ." },
        "ูุงุณููู": { w: "ูุนุชุฏู (ููุง ุงููุด ููุดู)", s: "ุดูุณ ูุงููุฉ", f: "ุณูุงุฏ ูุชูุงุฒู", n: "ูุจุงุช ูุชุณููุ ูุญุชุงุฌ ุฏุนุงูุฉ ูุณูุฏ ุนูููุง." },
        "ุฌุงุฑุฏูููุง": { w: "ููุฉ ุฎุงููุฉ ูู ุงููููุฑ (ููุชุฑ)", s: "ุถูุก ููู ุฌุฏุงู ุจุณ ูุด ุดูุณ ูุจุงุดุฑุฉ", f: "ุญุฏูุฏ ูุณูุงุฏ ุญุงูุถู", n: "ุฏููุนุฉ ุงููุดุชูุ ุจุชุฒุนู ูู ููุงููุง ุงุชุบูุฑ." },
        "ูุณู ุงูููู": { w: "ููู ูููู", s: "ุดูุณ ูุจุงุดุฑุฉ", f: "ุณูุงุฏ ุจูุฏู", n: "ุฑูุญุชู ุจุชููุฃ ุงูุดุงุฑุน ููู ุจููู." },
        "ุฌููููุฉ": { w: "ุชุนุทูุด ุนุดุงู ุชุฒูุฑ (ูููู)", s: "ุดูุณ ุญุงุฑูุฉ ุทูู ุงูููู", f: "ูุด ูุญุชุงุฌุฉ ุฏูุน", n: "ูู ูุง ุชูุดู ุนูููุง ุงูููุฉ ุชุทูุน ูุฑุฏ ุฃูุชุฑ." },
        "ูุงูุจุณูุณ": { w: "ููู ูููู ูู ุงูุตูู", s: "ุดูุณ ูุจุงุดุฑุฉ", f: "NPK ูู ุฃุณุจูุนูู", n: "ุฒูุฑุชูุง ุจุชุนูุด ููู ูุงุญุฏ ุจุณ ุดูููุง ุฑูุนุฉ." },
        "ูููุง": { w: "ูู ููู ูู ุงูุญุฑ", s: "ุดูุณ ุฃู ูุตู ุธู", f: "NPK ูุชุนุงุฏู", n: "ุฃููู ูุจุงุช ูุฒูุฑ ุจูุณุชุญูู ุญุฑุงุฑุฉ ูุตุฑ." },
        "ุฌุงุฑูููุง": { w: "ูุนุชุฏู", s: "ุดูุณ

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุดุชู ูุญูุฏ ุงูุฐูู - AI</title>
    
    <!-- Scripts & Styles -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'IBM Plex Sans Arabic', sans-serif;
            background-color: #fdfbf7;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        @keyframes bounce-subtle {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }
        .animate-bounce-subtle {
            animation: bounce-subtle 1.5s infinite ease-in-out;
        }
    </style>

    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0",
    "react-dom": "https://esm.sh/react-dom@18.2.0",
    "@google/genai": "https://esm.sh/@google/genai@1.40.0",
    "react-dom/": "https://esm.sh/react-dom@^19.2.4/",
    "react/": "https://esm.sh/react@^19.2.4/"
  }
}
</script>
</head>
<body class="overflow-hidden h-screen">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useRef } from 'react';
        import ReactDOM from 'react-dom';
        import { GoogleGenAI } from '@google/genai';

        // --- Constants & Database ---
        const PLANT_DB = {
            "ุฑูุญุงู": { w: "ููู ูููู (ุงูุชุฑุจุฉ ุฑุทุจุฉ ุฏุงุฆูุงู)", s: "ุดูุณ ูุจุงุดุฑุฉ ูููุงู ูุชููู", f: "ุณูุงุฏ ุนุถูู ูู ุดูุฑ", n: "ุงูุทู ุงูููู ุงููุงููุฉ ุนุดุงู ููุจุฑ ูููุฑุน." },
            "ูุนูุงุน": { w: "ูู ููู ูู ุงูุตูู (ุจูุญุจ ุงูููุฉ)", s: "ุดูุณ ุฎูููุฉ ุฃู ูุตู ุธู", f: "ุณูุงุฏ ูุชูุงุฒู NPK", n: "ุงูุฌุฐูุฑ ุจุชูุชุฏ ุจุณุฑุนุฉุ ููุถู ูู ุฃุตูุต ููุญุฏู." },
            "ุฑูุฒูุงุฑู": { w: "ููุง ุงูุชุฑุจุฉ ุชูุดู ุชูุงูุงู", s: "ุดูุณ ุญุงุฑูุฉ (ุจูุชุญูู)", f: "ูุด ูุญุชุงุฌ ุชุณููุฏ ูุชูุฑ", n: "ููุชุงุฒ ูู ุงูุทุจุฎ ูุฑูุญุชู ุจุชุทุฑุฏ ุงูุญุดุฑุงุช." },
            "ุฒุนุชุฑ": { w: "ูููู ุฌุฏุงู (ุจููุฑู ุงูููุฉ ุงููุชูุฑ)", s: "ุดูุณ ูุงููุฉ", f: "ูุฑุฉ ูู ููุณู", n: "ุนุดุจุฉ ูููุฉ ูุจุชุชุญูู ุงูุฌูุงู." },
            "ูุฑุฏ ุจูุฏู": { w: "ููู ูููู ุจุงูุชุธุงู", s: "ุดูุณ ูุจุงุดุฑุฉ 6 ุณุงุนุงุช ุนุงูุฃูู", f: "NPK ุนุงูู ุงูุจูุชุงุณููู ุนุดุงู ูุฒูุฑ", n: "ูุต ุงููุฑุฏ ุงูุฏุจูุงู ุฃูู ุจุฃูู ุนุดุงู ูุทูุน ุฌุฏูุฏ." },
            "ุจูุชุณ": { w: "ูู 4-5 ุฃูุงู (ููุง ุงูุชุฑุจุฉ ุชูุดู)", s: "ุถูุก ููุจุฉ ุฃู ุดุจุงู (ุถู)", f: "ุณูุงุฏ ูุฑูู", n: "ุฃุณูู ุฒุฑุนุฉ ูููุจุชุฏุฆููุ ุจุชุนูุด ูู ุฃู ุญุชุฉ." },
            "ุฌูุฏ ุงูููุฑ": { w: "ูู ุฃุณุจูุนูู ูุฑุฉ (ุงูุณุงู)", s: "ุฃู ุฅุถุงุกุฉ (ูููุฉ ุฃู ุถุนููุฉ)", f: "ูุด ูุญุชุงุฌ", n: "ุจูููู ุงูููุง ููุจูููุชุด ุจุณูููุฉ (ุญุฏูุฏ)." },
            "ุฒุงููุง": { w: "ูุฑุฉ ูู 20 ููู (ุฌุฐูุฑู ุจุชุฎุฒู ููุฉ)", s: "ุถู ูุงูู ุฃู ุถูุก ุฎููู", f: "NPK ูู ุดูุฑูู", n: "ุงูุฒุฑุนุฉ ุงูุดููุ ูุฑููุง ุจูููุน ููุญุฏู." },
        };

        const Icons = {
            Send: () => (
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5">
                    <path strokeLinecap="round" strokeLinejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" />
                </svg>
            ),
            Image: () => (
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5">
                    <path strokeLinecap="round" strokeLinejoin="round" d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6.75a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6.75v11.25a1.5 1.5 0 001.5 1.5z" />
                </svg>
            ),
            Magic: () => (
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5">
                    <path strokeLinecap="round" strokeLinejoin="round" d="M15.042 21.672L13.684 16.6m0 0l-2.51 2.225.569-3.47 2.82-1.741L12.63 12.29M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 01-1.043 3.296 3.745 3.745 0 01-3.296 1.043A3.745 3.745 0 0112 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 01-3.296-1.043 3.745 3.745 0 01-1.043-3.296A3.745 3.745 0 013 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 011.043-3.296 3.746 3.746 0 013.296-1.043A3.746 3.746 0 0112 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 013.296 1.043 3.746 3.746 0 011.043 3.296A3.745 3.745 0 0121 12z" />
                </svg>
            )
        };

        // --- API Services ---
        const getAI = () => new GoogleGenAI({ apiKey: window.process?.env?.API_KEY || '' });

        const analyzePlantImage = async (base64Image, prompt = "Analyze this plant. Identify it and provide care instructions.") => {
            const ai = getAI();
            const response = await ai.models.generateContent({
                model: 'gemini-3-pro-preview',
                contents: {
                    parts: [
                        { inlineData: { mimeType: 'image/jpeg', data: base64Image.split(',')[1] } },
                        { text: prompt }
                    ]
                },
                config: {
                    systemInstruction: "ุฃูุช ุฎุจูุฑ ูุจุงุชุงุช ูุญุชุฑู. ุฑุฏ ุจุงููุบุฉ ุงูุนุฑุจูุฉ. ูู ููุฌุฒุงู ููููุฏุงู."
                }
            });
            return response.text;
        };

        const chatWithBotanist = async (message, history) => {
            const ai = getAI();
            const response = await ai.models.generateContent({
                model: 'gemini-3-flash-preview',
                contents: [
                    ...history,
                    { role: 'user', parts: [{ text: message }] }
                ],
                config: {
                    systemInstruction: "ุฃูุช ุฎุจูุฑ ูู ุงูุนูุงูุฉ ุจุงููุจุงุชุงุช ูู ูุดุชู ูุญูุฏ ุงูุฐูู. ุฑุฏ ุจุงููุบุฉ ุงูุนุฑุจูุฉ ุจุฃุณููุจ ูุฏูุฏ ููููุฏ. ุฅุฐุง ุณุฃูู ุงููุณุชุฎุฏู ุนู ุงูุฃุณุนุงุฑุ ุฃุฎุจุฑู ุฃู ุงูุฃุณุนุงุฑ ูุชุบูุฑุฉ ููุฌุจ ุฒูุงุฑุฉ ุงููุดุชู.",
                }
            });
            return response.text;
        };

        const editPlantImage = async (base64Image, editPrompt) => {
            const ai = getAI();
            const response = await ai.models.generateContent({
                model: 'gemini-2.5-flash-image',
                contents: {
                    parts: [
                        { inlineData: { mimeType: 'image/jpeg', data: base64Image.split(',')[1] } },
                        { text: editPrompt }
                    ]
                }
            });
            const imgPart = response.candidates[0].content.parts.find(p => p.inlineData);
            return imgPart ? `data:image/png;base64,${imgPart.inlineData.data}` : null;
        };

        // --- Main App Component ---
        const App = () => {
            const [messages, setMessages] = useState([]);
            const [inputValue, setInputValue] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [selectedImage, setSelectedImage] = useState(null);
            const [isEditingMode, setIsEditingMode] = useState(false);
            const chatEndRef = useRef(null);
            const fileInputRef = useRef(null);

            const params = new URLSearchParams(window.location.search);
            const rawType = params.get('type') || 'ุนุงูุฉ';
            const plantType = rawType.replace(/_/g, ' ');

            useEffect(() => {
                const info = PLANT_DB[plantType];
                let welcomeText = `ูุง ุฃููุงู! ุฃูุง ูุณุงุนุฏู ุงูุฐูู ูู ูุดุชู ูุญูุฏ. ๐<br/>ุฃูุง ููุง ููุณุงุนุฏุชู ูู ุงูุนูุงูุฉ ุจู <b>${plantType}</b>.`;
                if (info) {
                    welcomeText += `<br/><br/>๐ก <b>ูุธุงู ุงูุฑู:</b> ${info.w}<br/>โ๏ธ <b>ุงูููุงู:</b> ${info.s}<br/>๐ <b>ุงูุชุณููุฏ:</b> ${info.f}`;
                }
                setMessages([{
                    id: '1',
                    text: welcomeText,
                    sender: 'bot',
                    timestamp: new Date()
                }]);
            }, [plantType]);

            useEffect(() => {
                chatEndRef.current?.scrollIntoView({ behavior: 'smooth' });
            }, [messages]);

            const handleSend = async () => {
                if (!inputValue.trim() && !selectedImage) return;

                const userMsg = {
                    id: Date.now().toString(),
                    text: inputValue,
                    sender: 'user',
                    timestamp: new Date(),
                    imageUrl: selectedImage,
                    isEditing: isEditingMode
                };

                setMessages(prev => [...prev, userMsg]);
                const currentInput = inputValue;
                const currentImage = selectedImage;
                const currentMode = isEditingMode;

                setInputValue('');
                setSelectedImage(null);
                setIsEditingMode(false);
                setIsLoading(true);

                try {
                    let botText = '';
                    let botImg = null;

                    if (currentImage && currentMode) {
                        botImg = await editPlantImage(currentImage, currentInput || "Improve this plant photo");
                        botText = botImg ? "ุชู ุชุนุฏูู ุงูุตูุฑุฉ ุจูุงุกู ุนูู ุทูุจู! โจ" : "ุนุฐุฑุงูุ ูู ุฃุณุชุทุน ุชุนุฏูู ุงูุตูุฑุฉ.";
                    } else if (currentImage) {
                        botText = await analyzePlantImage(currentImage, currentInput);
                    } else {
                        const history = messages.map(m => ({
                            role: m.sender === 'user' ? 'user' : 'model',
                            parts: [{ text: m.text }]
                        })).slice(-6);
                        botText = await chatWithBotanist(currentInput, history);
                    }

                    setMessages(prev => [...prev, {
                        id: (Date.now() + 1).toString(),
                        text: botText,
                        sender: 'bot',
                        timestamp: new Date(),
                        imageUrl: botImg
                    }]);
                } catch (e) {
                    setMessages(prev => [...prev, {
                        id: (Date.now() + 1).toString(),
                        text: "ุญุฏุซ ุฎุทุฃ. ุชุฃูุฏ ูู ุฅุนุฏุงุฏ ููุชุงุญ ุงูู API ุจุดูู ุตุญูุญ.",
                        sender: 'bot',
                        timestamp: new Date()
                    }]);
                } finally {
                    setIsLoading(false);
                }
            };

            const onFileChange = (e) => {
                const file = e.target.files?.[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        setSelectedImage(reader.result);
                        setIsEditingMode(false);
                    };
                    reader.readAsDataURL(file);
                }
            };

            return (
                <div className="flex flex-col h-screen max-w-2xl mx-auto bg-white shadow-2xl relative">
                    <header className="bg-emerald-800 text-white p-4 shadow-lg flex items-center justify-between sticky top-0 z-20">
                        <div className="flex items-center gap-3">
                            <div className="bg-emerald-100 p-2 rounded-full text-emerald-800 text-xl">๐ฑ</div>
                            <div>
                                <h1 className="font-bold text-lg leading-tight">ูุดุชู ูุญูุฏ ุงูุฐูู</h1>
                                <p className="text-xs text-emerald-200">ูุณุงุนุฏู ุงููุจุงุชู ุงูุดุฎุตู</p>
                            </div>
                        </div>
                    </header>

                    <div className="flex-1 overflow-y-auto p-4 space-y-4 bg-[#f9fafb] custom-scrollbar">
                        {messages.map((msg) => (
                            <div key={msg.id} className={`flex ${msg.sender === 'user' ? 'justify-end' : 'justify-start'}`}>
                                <div className={`max-w-[85%] rounded-2xl p-4 shadow-sm transition-all ${
                                    msg.sender === 'user' ? 'bg-emerald-600 text-white rounded-br-none' : 'bg-white text-slate-800 border border-slate-100 rounded-bl-none'
                                }`}>
                                    {msg.imageUrl && (
                                        <div className="mb-2 rounded-lg overflow-hidden border border-slate-200">
                                            <img src={msg.imageUrl} className="max-w-full h-auto object-cover max-h-64" />
                                        </div>
                                    )}
                                    <div className="text-sm md:text-base whitespace-pre-wrap leading-relaxed" dangerouslySetInnerHTML={{ __html: msg.text }} />
                                    <div className="text-[10px] mt-1 opacity-60">
                                        {msg.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}
                                    </div>
                                </div>
                            </div>
                        ))}
                        {isLoading && (
                            <div className="flex justify-start">
                                <div className="bg-white border border-slate-100 p-4 rounded-2xl rounded-bl-none shadow-sm flex gap-1">
                                    <div className="w-2 h-2 bg-emerald-500 rounded-full animate-bounce"></div>
                                    <div className="w-2 h-2 bg-emerald-500 rounded-full animate-bounce [animation-delay:0.2s]"></div>
                                    <div className="w-2 h-2 bg-emerald-500 rounded-full animate-bounce [animation-delay:0.4s]"></div>
                                </div>
                            </div>
                        )}
                        <div ref={chatEndRef} />
                    </div>

                    <div className="p-4 bg-white border-t border-slate-200">
                        {selectedImage && (
                            <div className="mb-3 flex items-center gap-3 bg-slate-50 p-2 rounded-xl border border-slate-200">
                                <div className="relative">
                                    <img src={selectedImage} className="w-16 h-16 rounded-lg object-cover border border-slate-300" />
                                    <button onClick={() => setSelectedImage(null)} className="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 text-xs">โ</button>
                                </div>
                                <div className="flex-1 flex flex-col gap-1">
                                    <span className="text-xs font-medium text-slate-600">ุตูุฑุฉ ูุฑููุฉ</span>
                                    <button onClick={() => setIsEditingMode(!isEditingMode)} className={`text-[10px] px-2 py-1 rounded-full w-fit flex items-center gap-1 ${isEditingMode ? 'bg-purple-100 text-purple-700 font-bold' : 'bg-slate-200 text-slate-600'}`}>
                                        <Icons.Magic /> {isEditingMode ? 'ูุถุน ุงูุชุนุฏูู ููุนู' : 'ุชุนุฏูู ุงูุตูุฑุฉ ุจุงูุฐูุงุกุ'}
                                    </button>
                                </div>
                            </div>
                        )}

                        <div className="flex items-center gap-2 bg-slate-100 rounded-3xl p-1 pr-4 shadow-inner">
                            <input
                                type="text"
                                className="flex-1 bg-transparent border-none focus:ring-0 text-sm py-2"
                                placeholder={isEditingMode ? "ุตู ุงูุชุนุฏูู..." : "ุงุณุฃููู ุฃู ุดูุก..."}
                                value={inputValue}
                                onChange={(e) => setInputValue(e.target.value)}
                                onKeyPress={(e) => e.key === 'Enter' && handleSend()}
                            />
                            <div className="flex items-center gap-1">
                                <input type="file" accept="image/*" className="hidden" ref={fileInputRef} onChange={onFileChange} />
                                <button onClick={() => fileInputRef.current?.click()} className="p-2 text-slate-500 hover:text-emerald-600">
                                    <Icons.Image />
                                </button>
                                <button onClick={handleSend} disabled={isLoading} className={`p-3 rounded-full ${isLoading ? 'bg-slate-300' : 'bg-emerald-600 text-white'}`}>
                                    <Icons.Send />
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
